% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_processing.R
\name{select_stat_sign}
\alias{select_stat_sign}
\title{Select Statistically Significant Differentially Expressed Genes}
\usage{
select_stat_sign(
  dge,
  stat_sign,
  p_threshold = 0.05,
  logFC_threshold = 1,
  keep_empty = FALSE
)
}
\arguments{
\item{dge}{A data frame of DE results or a list of data frames.
Each data frame must contain:
\itemize{
\item a significance column (specified by \code{stat_sign})
\item a \code{logFC} column (log fold-change)
}}

\item{stat_sign}{Character string. Name of the significance column
(e.g., \code{"p.value"}, \code{"adj.P.Val"}, \code{"padj"}).}

\item{p_threshold}{Numeric. Significance cutoff applied to \code{stat_sign}.
Default is \code{0.05}.}

\item{logFC_threshold}{Numeric. Absolute log fold-change cutoff.
Genes are kept when \code{abs(logFC) >= logFC_threshold}. Default is \code{1}.}

\item{keep_empty}{Logical. If \code{TRUE}, keeps empty filtered data frames in the output
(useful when you want to preserve the full set of contrasts). If \code{FALSE} (default),
drops empty results.}
}
\value{
If \code{dge} is a data frame, returns a filtered data frame.
If \code{dge} is a list, returns a list of filtered data frames.
Elements that are not data frames or that lack required columns are skipped with a warning.
}
\description{
Filters differential expression (DE) results by statistical significance and
absolute log fold-change. The input can be either:
\itemize{
\item a single data frame of DE results, or
\item a named (or unnamed) list of DE result data frames (e.g. one per contrast).
}
}
\details{
The function:
\itemize{
\item Removes rows with \code{NA} in either \code{stat_sign} or \code{logFC}.
\item Filters rows with \code{dge[[stat_sign]] < p_threshold}.
\item Filters rows with \code{abs(logFC) >= logFC_threshold}.
}
}
\examples{
\dontrun{
dge_list <- list(
  condition1 = data.frame(p.value = runif(100), logFC = rnorm(100)),
  condition2 = data.frame(p.value = runif(100), logFC = rnorm(100))
)

filtered_list <- select_stat_sign(dge_list, stat_sign = "p.value", logFC_threshold = 1)

# Single data.frame also works:
filtered_df <- select_stat_sign(dge_list$condition1, stat_sign = "p.value", logFC_threshold = 1)
}

}
