% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis_PCA.R
\name{pcafun}
\alias{pcafun}
\title{Perform and Plot PCA with Customizable Aesthetics}
\usage{
pcafun(
  counts,
  metadata,
  title,
  colby = "samples",
  shapekey = NULL,
  showLoadings = TRUE
)
}
\arguments{
\item{counts}{A numeric matrix or data frame containing count data (e.g., TMM or TPM values) with rows as features (e.g., genes)
and columns as samples.}

\item{metadata}{A data frame containing sample metadata. The row names of \code{metadata} should correspond to the column names of \code{counts}.}

\item{title}{A character string for the PCA plot title.}

\item{colby}{A character string specifying the column name in \code{metadata} used to color the samples in the PCA plot.
Default is \code{"samples"}.}

\item{shapekey}{An optional character string specifying the column name in \code{metadata} used to shape the points in the PCA plot.
Default is \code{NULL}, meaning no special grouping by shape.}

\item{showLoadings}{A logical value indicating whether to display the loadings on the PCA biplot.
Default is \code{TRUE}.}
}
\value{
A \code{ggplot} object representing the PCA biplot.
}
\description{
This function performs Principal Component Analysis (PCA) on a count matrix and generates a biplot
using \code{PCAtools}. It streamlines the workflow—especially for pathway-specific PCAs—by performing the analysis
and plotting in one step.
}
\details{
This function leverages \code{PCAtools::pca} to compute the principal components and \code{PCAtools::biplot} to create the biplot.
By providing customizable parameters for both color and shape aesthetics (via \code{colby} and \code{shapekey}), along with
an option to toggle the display of loadings, this function enables users to quickly generate tailored PCA visualizations
without manually calculating PCA and then plotting it separately.
}
\examples{
\dontrun{
# Assume counts is your count matrix and metadata contains corresponding sample information:
pca_plot <- pcafun(counts, metadata, title = "Pathway-Specific PCA",
                   colby = "treatment", shapekey = "batch", showLoadings = FALSE)
}

}
