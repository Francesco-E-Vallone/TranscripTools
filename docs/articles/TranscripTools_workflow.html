<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>TranscripTools — Practical analysis workflow • TranscripTools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TranscripTools — Practical analysis workflow">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TranscripTools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>TranscripTools — Practical analysis workflow</h1>
            
      

      <div class="d-none name"><code>TranscripTools_workflow.Rmd</code></div>
    </div>

    
    
<p>TranscripTools is a small, pragmatic toolbox for bulk RNA-seq
downstream work <strong>when you have many comparisons</strong>.</p>
<p>It does <strong>not</strong> do differential expression.<br>
It helps with the repetitive parts that happen <em>after</em> edgeR /
limma / DESeq2: consistent filtering, quick plots, enrichment wrappers,
and export.</p>
<p>This guide is intentionally written as a <strong>realistic usage
workflow</strong> (not toy-data tutorial).<br>
You should be able to scan it and immediately know <em>which function is
for what</em> and <em>where it fits</em>.</p>
<hr>
<div class="section level2">
<h2 id="start-from-raw-count-files-optional-create_df">1. Start from raw count files (optional) —
<code>create_df()</code><a class="anchor" aria-label="anchor" href="#start-from-raw-count-files-optional-create_df"></a>
</h2>
<p>If you begin from multiple raw count files (e.g., featureCounts-style
outputs), <code><a href="../reference/create_df.html">create_df()</a></code> can merge them into one count
matrix-like data.frame.</p>
<p>What it does (high level):</p>
<ul>
<li>reads each file (expects a simple two-column structure: gene ID +
counts)</li>
<li>appends the counts column to a growing table</li>
<li>keeps only the <code>counts_*</code> columns in the final
object</li>
<li>removes technical rows like <code>no_feature</code>,
<code>ambiguous</code>, etc. if present</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://francesco-e-vallone.github.io/TranscripTools/">TranscripTools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># base object to start from (can be empty)</span></span>
<span><span class="va">raw_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vector of raw count files (one per sample)</span></span>
<span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"path/to/counts"</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">"\\.txt$"</span>,</span>
<span>  full.names <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">counts_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_df.html">create_df</a></span><span class="op">(</span><span class="va">raw_counts</span>, <span class="va">files</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># from here you typically:</span></span>
<span><span class="co"># - set rownames to gene IDs if needed</span></span>
<span><span class="co"># - normalize outside TranscripTools (edgeR::calcNormFactors, CPM/TPM, etc.)</span></span></code></pre></div>
<p><strong>Important:</strong> <code><a href="../reference/create_df.html">create_df()</a></code> is about
<strong>building the count table</strong>.<br>
Normalization (TMM/TPM/logCPM) is done in your main pipeline
(edgeR/limma/DESeq2).</p>
<hr>
</div>
<div class="section level2">
<h2 id="what-you-usually-have-after-de-is-run">2. What you usually have after DE is run<a class="anchor" aria-label="anchor" href="#what-you-usually-have-after-de-is-run"></a>
</h2>
<p>Most of the package assumes you have:</p>
<ul>
<li>
<code>tmm</code>: normalized expression matrix (TMM / TPM / logCPM /
similar), genes × samples</li>
<li>
<code>meta</code>: sample metadata (rownames = sample IDs)</li>
<li>
<code>res</code>: a <strong>named list</strong> of DE results, one
data.frame per contrast (rownames = gene symbols)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># res  &lt;- readRDS(".../DGE_results.rds")   # named list of data.frames</span></span>
<span><span class="co"># tmm  &lt;- readRDS(".../TMM_counts.rds")    # genes x samples</span></span>
<span><span class="co"># meta &lt;- readRDS(".../metadata.rds")      # rownames = samples (match colnames(tmm))</span></span></code></pre></div>
<div class="section level3">
<h3 id="optional-average-technicalbiological-replicates-average_cols">2.1 Optional: average technical/biological replicates —
<code>average_cols()</code><a class="anchor" aria-label="anchor" href="#optional-average-technicalbiological-replicates-average_cols"></a>
</h3>
<p>If you have replicate samples and you want a <strong>group-level
matrix</strong> (one column per group), use
<code><a href="../reference/average_cols.html">average_cols()</a></code>.</p>
<ul>
<li>Input: <code>tmm</code> (genes × samples) and <code>meta</code> with
a column called <strong><code>group</code></strong>
</li>
<li>Output: a data.frame with genes × <strong>groups</strong>
</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmm_avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/average_cols.html">average_cols</a></span><span class="op">(</span><span class="va">tmm</span>, <span class="va">meta</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now you can use tmm_avg for “one column per group” heatmaps / PCA</span></span>
<span><span class="fu"><a href="../reference/pcafun.html">pcafun</a></span><span class="op">(</span></span>
<span>  counts   <span class="op">=</span> <span class="va">tmm_avg</span>,</span>
<span>  metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tmm_avg</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tmm_avg</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  colby    <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  title    <span class="op">=</span> <span class="st">"PCA on averaged groups"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If you <em>don’t</em> want averaging, skip this and keep using the
original <code>tmm</code>.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="global-structure-first-pca-early-pcafun">3. Global structure first (PCA early) — <code>pcafun()</code><a class="anchor" aria-label="anchor" href="#global-structure-first-pca-early-pcafun"></a>
</h2>
<p>Before zooming into DE genes, I want to see:</p>
<ul>
<li>does condition separate at all?</li>
<li>is batch dominating?</li>
<li>do I have obvious outliers?</li>
</ul>
<p>What you get back: a <strong>ggplot object</strong> (so you can store
it, add layers, or save it).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pcafun.html">pcafun</a></span><span class="op">(</span></span>
<span>  counts   <span class="op">=</span> <span class="va">tmm</span>,</span>
<span>  metadata <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  colby    <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>  shapekey <span class="op">=</span> <span class="st">"batch"</span>,</span>
<span>  title    <span class="op">=</span> <span class="st">"Global PCA"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This step is not “one and done”. It’s something you rerun after each
refinement (DE genes, pathway genes, etc.).</p>
<hr>
</div>
<div class="section level2">
<h2 id="make-de-results-consistent-add_significance">4. Make DE results consistent — <code>add_significance()</code><a class="anchor" aria-label="anchor" href="#make-de-results-consistent-add_significance"></a>
</h2>
<p>Standardize the output of all contrasts in the same way (so
downstream steps behave consistently).</p>
<p>What you get back: your same list of contrasts, but with a
standardized <code>sign</code> column added.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="va">res</span>,</span>
<span>  <span class="va">add_significance</span>,</span>
<span>  fdr_col   <span class="op">=</span> <span class="st">"adj.P.Val"</span>,</span>
<span>  logFC_col <span class="op">=</span> <span class="st">"logFC"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This adds a <code>sign</code> column (<code>Up</code>,
<code>Down</code>, <code>NS</code>) using the thresholds you defined in
the function.</p>
<hr>
</div>
<div class="section level2">
<h2 id="quick-per-contrast-sanity-checks-volplot">5. Quick per-contrast sanity checks — <code>volplot()</code><a class="anchor" aria-label="anchor" href="#quick-per-contrast-sanity-checks-volplot"></a>
</h2>
<p>Volcano plots are fast diagnostics:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/volplot.html">volplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">[[</span><span class="st">"NM_vs_NWT"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>I use them to catch: - contrasts with basically no signal - weird
distributions (e.g., batch-driven results) - “filtering will kill
everything” situations</p>
<hr>
</div>
<div class="section level2">
<h2 id="define-the-working-gene-set-select_stat_sign">6. Define the working gene set —
<code>select_stat_sign()</code><a class="anchor" aria-label="anchor" href="#define-the-working-gene-set-select_stat_sign"></a>
</h2>
<p>Single contrast:</p>
<p>What you get back: a filtered <strong>data.frame</strong> (same
columns as the input DE table).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sig_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_stat_sign.html">select_stat_sign</a></span><span class="op">(</span></span>
<span>  <span class="va">res</span><span class="op">[[</span><span class="st">"NM_vs_NWT"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  stat_sign <span class="op">=</span> <span class="st">"adj.P.Val"</span>,</span>
<span>  logFC_threshold <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Across many contrasts:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_sign</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="va">res</span>,</span>
<span>  <span class="va">select_stat_sign</span>,</span>
<span>  stat_sign <span class="op">=</span> <span class="st">"adj.P.Val"</span>,</span>
<span>  logFC_threshold <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>At this point, <code>sig_df</code> / <code>res_sign[[...]]</code> is
the typical input for: - GO analysis - DE-gene heatmaps - DE-gene PCA -
gene-level plots</p>
<hr>
</div>
<div class="section level2">
<h2 id="go-back-to-structure-using-de-genes-pcafun-hmap">7. Go back to structure using DE genes — <code>pcafun()</code> +
<code>hmap()</code><a class="anchor" aria-label="anchor" href="#go-back-to-structure-using-de-genes-pcafun-hmap"></a>
</h2>
<p>This is where analysis becomes <em>iterative</em>, not linear.</p>
<div class="section level3">
<h3 id="pca-on-de-genes">7.1 PCA on DE genes<a class="anchor" aria-label="anchor" href="#pca-on-de-genes"></a>
</h3>
<p>What you get back: a <strong>ggplot object</strong> (so you can store
it, add layers, or save it).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pcafun.html">pcafun</a></span><span class="op">(</span></span>
<span>  counts   <span class="op">=</span> <span class="va">tmm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sig_df</span><span class="op">)</span>, <span class="op">]</span>,</span>
<span>  metadata <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  colby    <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>  shapekey <span class="op">=</span> <span class="st">"batch"</span>,</span>
<span>  title    <span class="op">=</span> <span class="st">"PCA on DE genes"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="heatmap-on-de-genes">7.2 Heatmap on DE genes<a class="anchor" aria-label="anchor" href="#heatmap-on-de-genes"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hmap.html">hmap</a></span><span class="op">(</span></span>
<span>  <span class="va">tmm</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"DE genes — NM vs NWT"</span>,</span>
<span>  deg   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sig_df</span><span class="op">)</span>,</span>
<span>  metadata     <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  metadata_col <span class="op">=</span> <span class="st">"condition"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="enrichment-up-down-up_go-and-down_go">8. Enrichment (UP / DOWN) — <code>up_go()</code> and
<code>down_go()</code><a class="anchor" aria-label="anchor" href="#enrichment-up-down-up_go-and-down_go"></a>
</h2>
<p>What you get back: a <strong>named list of ggplot objects</strong>,
one per database. Missing/empty databases are simply skipped (you might
see warnings; that’s normal in real data).</p>
<p>At this stage the question becomes: <em>what biology is driving the
signal?</em></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">up_go_res</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/up_go.html">up_go</a></span><span class="op">(</span><span class="va">sig_df</span>,   samples <span class="op">=</span> <span class="st">"NM_vs_NWT"</span><span class="op">)</span></span>
<span><span class="va">down_go_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/down_go.html">down_go</a></span><span class="op">(</span><span class="va">sig_df</span>, samples <span class="op">=</span> <span class="st">"NM_vs_NWT"</span><span class="op">)</span></span></code></pre></div>
<p>Across many contrasts (typical loop):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_up_go</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">all_down_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">nm</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res_sign</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">res_sign</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw">next</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sign</span> <span class="op">==</span> <span class="st">"Up"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">all_up_go</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/up_go.html">up_go</a></span><span class="op">(</span><span class="va">df</span>, samples <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sign</span> <span class="op">==</span> <span class="st">"Down"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">all_down_go</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/down_go.html">down_go</a></span><span class="op">(</span><span class="va">df</span>, samples <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="inspect-save-enrichment-plots-enrichplot-save_plot">9. Inspect &amp; save enrichment plots — <code>enrichPlot()</code> +
<code>save_plot()</code><a class="anchor" aria-label="anchor" href="#inspect-save-enrichment-plots-enrichplot-save_plot"></a>
</h2>
<p>Quick visualization:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/enrichPlot.html">enrichPlot</a></span><span class="op">(</span><span class="va">up_go_res</span><span class="op">)</span></span></code></pre></div>
<p>Save consistently:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/enrichPlot.html">enrichPlot</a></span><span class="op">(</span><span class="va">up_go_res</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="st">"NM_vs_NWT_UP_GO"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="pathway-genes-back-into-pcaheatmap-deg_in_pathway">10. Pathway → genes → back into PCA/heatmap —
<code>deg_in_pathway()</code><a class="anchor" aria-label="anchor" href="#pathway-genes-back-into-pcaheatmap-deg_in_pathway"></a>
</h2>
<p>This is one of the main reasons TranscripTools exists:
<strong>closing the loop</strong>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deg_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deg_in_pathway.html">deg_in_pathway</a></span><span class="op">(</span></span>
<span>  deg_df  <span class="op">=</span> <span class="va">sig_df</span>,</span>
<span>  pathway <span class="op">=</span> <span class="st">"NF-kB signaling"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now reuse that gene set:</p>
<p>What you get back: a <strong>ggplot object</strong> (so you can store
it, add layers, or save it).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pcafun.html">pcafun</a></span><span class="op">(</span></span>
<span>  counts   <span class="op">=</span> <span class="va">tmm</span><span class="op">[</span><span class="va">deg_path</span><span class="op">$</span><span class="va">gene</span>, <span class="op">]</span>,</span>
<span>  metadata <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  colby    <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>  shapekey <span class="op">=</span> <span class="st">"batch"</span>,</span>
<span>  title    <span class="op">=</span> <span class="st">"PCA — NF-kB pathway genes"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/hmap.html">hmap</a></span><span class="op">(</span></span>
<span>  <span class="va">tmm</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"NF-kB pathway genes"</span>,</span>
<span>  deg   <span class="op">=</span> <span class="va">deg_path</span><span class="op">$</span><span class="va">gene</span>,</span>
<span>  metadata     <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  metadata_col <span class="op">=</span> <span class="st">"condition"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This is the pattern:<br><strong>Global → DE genes → pathway genes → structure
again.</strong></p>
<hr>
</div>
<div class="section level2">
<h2 id="gene-level-visualization-exploration-reporting">11. Gene-level visualization (exploration + reporting)<a class="anchor" aria-label="anchor" href="#gene-level-visualization-exploration-reporting"></a>
</h2>
<div class="section level3">
<h3 id="barplot-for-top-de-genes-deg_barplot">11.1 Barplot for top DE genes — <code>deg_barplot()</code><a class="anchor" aria-label="anchor" href="#barplot-for-top-de-genes-deg_barplot"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/deg_barplot.html">deg_barplot</a></span><span class="op">(</span></span>
<span>  <span class="va">sig_df</span>,</span>
<span>  <span class="va">tmm</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Top DE genes"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="expression-distributions-whiskyplot">11.2 Expression distributions — <code>whiskyplot()</code><a class="anchor" aria-label="anchor" href="#expression-distributions-whiskyplot"></a>
</h3>
<p>What you get back: a <strong>ggplot object</strong>.</p>
<p>Stats note (important): <code><a href="../reference/whiskyplot.html">whiskyplot()</a></code> runs a
<strong>pairwise test per gene</strong> (Wilcoxon or t-test via
<code>rstatix</code>) and then annotates the plot with p-values. If you
need the <strong>actual statistics table</strong> for reporting
(group1/group2, p, p.adj, etc.), you currently have two options:</p>
<ol style="list-style-type: decimal">
<li>re-run the same <code>rstatix::pairwise_*_test()</code> on the
long-format data (you already have the recipe in the function), or</li>
<li>(better) we add a <code>return_stats = TRUE</code> option that
returns <code>list(plot = p, stats = stat_df)</code>.</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/whiskyplot.html">whiskyplot</a></span><span class="op">(</span></span>
<span>  tmm       <span class="op">=</span> <span class="va">tmm</span>,</span>
<span>  genes     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MYC"</span>, <span class="st">"BCL2"</span><span class="op">)</span>,</span>
<span>  metadata  <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  group_col <span class="op">=</span> <span class="st">"condition"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quick-summaries-plot_genes_stats">11.3 Quick summaries — <code>plot_genes_stats()</code><a class="anchor" aria-label="anchor" href="#quick-summaries-plot_genes_stats"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_genes_stats.html">plot_genes_stats</a></span><span class="op">(</span></span>
<span>  tmm      <span class="op">=</span> <span class="va">tmm</span>,</span>
<span>  genes    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MYC"</span>, <span class="st">"BCL2"</span><span class="op">)</span>,</span>
<span>  metadata <span class="op">=</span> <span class="va">meta</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="organizing-outputs-across-many-contrasts-exports">12. Organizing outputs across many contrasts (exports)<a class="anchor" aria-label="anchor" href="#organizing-outputs-across-many-contrasts-exports"></a>
</h2>
<div class="section level3">
<h3 id="go-outputs-nested-export-ready">12.1 GO outputs: nested → export-ready<a class="anchor" aria-label="anchor" href="#go-outputs-nested-export-ready"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">go_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_go_list.html">build_go_list</a></span><span class="op">(</span></span>
<span>  up_list   <span class="op">=</span> <span class="va">all_up_go</span>,</span>
<span>  down_list <span class="op">=</span> <span class="va">all_down_go</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">go_export</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_go_exp.html">prep_go_exp</a></span><span class="op">(</span><span class="va">go_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># writexl::write_xlsx(go_export, "GO_tables.xlsx")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="de-outputs-list-export-ready">12.2 DE outputs: list → export-ready<a class="anchor" aria-label="anchor" href="#de-outputs-list-export-ready"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deg_export</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_deg_export.html">prep_deg_export</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># writexl::write_xlsx(deg_export, "DE_tables.xlsx")</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="notes">13. Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>TranscripTools follows the way I actually work on bulk RNA-seq
projects:</p>
<ul>
<li>I sanity-check global structure early (PCA/outliers/batch).</li>
<li>I define a clean DEG set, then refine it (DE → pathway →
genes).</li>
<li>I keep looping between “global” and “focused” views instead of
pretending analysis is linear.</li>
<li>I export results in a consistent way, because comparisons pile up
fast.</li>
</ul>
<p>If you’re doing a single contrast once, you can just write a
script.<br>
If you’re doing many contrasts across projects, this saves time and
keeps the workflow readable.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Francesco Edoardo Vallone.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
